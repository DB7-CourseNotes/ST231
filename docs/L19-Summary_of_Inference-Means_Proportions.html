<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.333">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Devan Becker">
<meta name="dcterms.date" content="2023-07-19">

<title>Statistics for Life Sciences - 21&nbsp; Inference: Overview, R Code, and Special Topics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./L23-ANOVA-oi.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./L12-Intro_to_Inference-CI-pvals.html">Post-Midterm</a></li><li class="breadcrumb-item"><a href="./L19-Summary_of_Inference-Means_Proportions.html"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Inference: Overview, R Code, and Special Topics</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Statistics for Life Sciences</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/DB7-CourseNotes/ST231_S23" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <a href="./Statistics-for-Life-Sciences.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Pre-Midterm</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./L01-Intro_PicturingGraphs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Picturing Distributions with Graphs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./L02-Describing_Distributions_Numbers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Describing Distributions with Numbers</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./L03-Scatterplots_Correlation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Scatterplots and Correlation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./L04-Regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./L05-Probability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Probability Background</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./L07-Normal_Distributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">The Normal Distributions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./L09-Binomial_Probabilities.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Binomial Probabilities</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./L10-Sampling_Distributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Sampling Distributions</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Post-Midterm</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./L12-Intro_to_Inference-CI-pvals.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Welcome to Inference!</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./L13-p_vals.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Tests of Significance</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./L14-Inference_Cautions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Special Topics in Inference</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./L15-CI_for_Means.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Confidence Intervals in Practice</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./L16-Hypothesis_Tests_for_Means.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">t-Tests for a Mean</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./L17-Two_Sample_hypothesis_Tests.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Two-Sample t-Tests</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./L18-Hypothesis_Tests_for_Proportions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Large sample test for a proportion</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./L19-CI_for_Proportions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Confidence Intervals for a Proportion</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./L20-Two_Proportions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Inference for the Difference in Proportions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./L21-ChiSquare_Multiple_Proportions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Chi-Square Test for Multiple Proportions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./L22-Inference_for_Regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Inference for Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./L23-ANOVA-oi.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Comparing means with ANOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./L19-Summary_of_Inference-Means_Proportions.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Inference: Overview, R Code, and Special Topics</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#inference-is-the-inverse-of-probability" id="toc-inference-is-the-inverse-of-probability" class="nav-link active" data-scroll-target="#inference-is-the-inverse-of-probability"><span class="header-section-number">21.1</span> Inference is the Inverse of Probability</a></li>
  <li><a href="#inference-about-a-mean-sigma-known" id="toc-inference-about-a-mean-sigma-known" class="nav-link" data-scroll-target="#inference-about-a-mean-sigma-known"><span class="header-section-number">21.2</span> Inference about a Mean, <span class="math inline">\(\sigma\)</span> known</a>
  <ul class="collapse">
  <li><a href="#assumptions" id="toc-assumptions" class="nav-link" data-scroll-target="#assumptions">Assumptions</a></li>
  <li><a href="#sampling-distribution" id="toc-sampling-distribution" class="nav-link" data-scroll-target="#sampling-distribution">Sampling Distribution</a></li>
  <li><a href="#confidence-interval" id="toc-confidence-interval" class="nav-link" data-scroll-target="#confidence-interval">Confidence Interval</a></li>
  <li><a href="#hypothesis-test" id="toc-hypothesis-test" class="nav-link" data-scroll-target="#hypothesis-test">Hypothesis test</a></li>
  <li><a href="#r-code-for-z" id="toc-r-code-for-z" class="nav-link" data-scroll-target="#r-code-for-z">R Code for z</a></li>
  </ul></li>
  <li><a href="#inference-about-a-mean-sigma-estimated-by-s" id="toc-inference-about-a-mean-sigma-estimated-by-s" class="nav-link" data-scroll-target="#inference-about-a-mean-sigma-estimated-by-s"><span class="header-section-number">21.3</span> Inference about a Mean, <span class="math inline">\(\sigma\)</span> estimated by <span class="math inline">\(s\)</span></a>
  <ul class="collapse">
  <li><a href="#assumptions-1" id="toc-assumptions-1" class="nav-link" data-scroll-target="#assumptions-1">Assumptions</a></li>
  <li><a href="#sampling-distribution-1" id="toc-sampling-distribution-1" class="nav-link" data-scroll-target="#sampling-distribution-1">Sampling Distribution</a></li>
  <li><a href="#confidence-interval-1" id="toc-confidence-interval-1" class="nav-link" data-scroll-target="#confidence-interval-1">Confidence Interval</a></li>
  <li><a href="#hypothesis-test-1" id="toc-hypothesis-test-1" class="nav-link" data-scroll-target="#hypothesis-test-1">Hypothesis Test</a></li>
  <li><a href="#r-code-for-t" id="toc-r-code-for-t" class="nav-link" data-scroll-target="#r-code-for-t">R Code for t</a></li>
  </ul></li>
  <li><a href="#two-sample-t-tests" id="toc-two-sample-t-tests" class="nav-link" data-scroll-target="#two-sample-t-tests"><span class="header-section-number">21.4</span> Two-Sample t-tests</a>
  <ul class="collapse">
  <li><a href="#assumptions-2" id="toc-assumptions-2" class="nav-link" data-scroll-target="#assumptions-2">Assumptions</a></li>
  <li><a href="#sampling-distribution-2" id="toc-sampling-distribution-2" class="nav-link" data-scroll-target="#sampling-distribution-2">Sampling Distribution</a></li>
  <li><a href="#confidence-intervals" id="toc-confidence-intervals" class="nav-link" data-scroll-target="#confidence-intervals">Confidence Intervals</a></li>
  <li><a href="#hypothesis-tests" id="toc-hypothesis-tests" class="nav-link" data-scroll-target="#hypothesis-tests">Hypothesis Tests</a></li>
  <li><a href="#r-code-for-two-sample-t-tests" id="toc-r-code-for-two-sample-t-tests" class="nav-link" data-scroll-target="#r-code-for-two-sample-t-tests">R Code for two-sample t-tests</a></li>
  </ul></li>
  <li><a href="#inference-about-a-proportion" id="toc-inference-about-a-proportion" class="nav-link" data-scroll-target="#inference-about-a-proportion"><span class="header-section-number">21.5</span> Inference about a Proportion</a>
  <ul class="collapse">
  <li><a href="#assumptions-3" id="toc-assumptions-3" class="nav-link" data-scroll-target="#assumptions-3">Assumptions</a></li>
  <li><a href="#sampling-distribution-3" id="toc-sampling-distribution-3" class="nav-link" data-scroll-target="#sampling-distribution-3">Sampling Distribution</a></li>
  <li><a href="#confidence-intervals-1" id="toc-confidence-intervals-1" class="nav-link" data-scroll-target="#confidence-intervals-1">Confidence Intervals</a></li>
  <li><a href="#hypothesis-tests-1" id="toc-hypothesis-tests-1" class="nav-link" data-scroll-target="#hypothesis-tests-1">Hypothesis tests</a></li>
  <li><a href="#r-code-for-p" id="toc-r-code-for-p" class="nav-link" data-scroll-target="#r-code-for-p">R Code for p</a></li>
  </ul></li>
  <li><a href="#special-topics-in-inference" id="toc-special-topics-in-inference" class="nav-link" data-scroll-target="#special-topics-in-inference"><span class="header-section-number">21.6</span> Special Topics in Inference</a>
  <ul class="collapse">
  <li><a href="#sample-size-calculations" id="toc-sample-size-calculations" class="nav-link" data-scroll-target="#sample-size-calculations">Sample Size Calculations</a></li>
  <li><a href="#sample-size-calculations-2" id="toc-sample-size-calculations-2" class="nav-link" data-scroll-target="#sample-size-calculations-2">Sample Size Calculations 2</a></li>
  <li><a href="#inference-for-other-parameters" id="toc-inference-for-other-parameters" class="nav-link" data-scroll-target="#inference-for-other-parameters">Inference for Other Parameters</a></li>
  <li><a href="#bayesian-inference" id="toc-bayesian-inference" class="nav-link" data-scroll-target="#bayesian-inference">Bayesian Inference</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/DB7-CourseNotes/ST231_S23/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Inference: Overview, R Code, and Special Topics</span></h1>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Devan Becker </p>
  </div>
    <div class="quarto-title-meta-contents">
        <p class="affiliation">
            Wilfrid Laurier University
          </p>
      </div>
    </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">2023-07-19</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="inference-is-the-inverse-of-probability" class="level2" data-number="21.1">
<h2 data-number="21.1" class="anchored" data-anchor-id="inference-is-the-inverse-of-probability"><span class="header-section-number">21.1</span> Inference is the Inverse of Probability</h2>
<p>There is some true population parameter. When we collect a sample, we can a random collection of observations from this population parameter. In other words, we get randomness from a population value - this is Probability.</p>
<p>If we make assumptions about our data, we have the benefit of math. This math allows us to go backwards and say something aboot the population. In other words, we get a population value from randomess - this is Inference.</p>
</section>
<section id="inference-about-a-mean-sigma-known" class="level2" data-number="21.2">
<h2 data-number="21.2" class="anchored" data-anchor-id="inference-about-a-mean-sigma-known"><span class="header-section-number">21.2</span> Inference about a Mean, <span class="math inline">\(\sigma\)</span> known</h2>
<section id="assumptions" class="level3">
<h3 class="anchored" data-anchor-id="assumptions">Assumptions</h3>
<ol type="1">
<li>SRS from the population of interest
<ul>
<li>This ensures independence between observations</li>
</ul></li>
<li>Population is normal</li>
<li>We know <span class="math inline">\(\sigma\)</span></li>
</ol>
</section>
<section id="sampling-distribution" class="level3">
<h3 class="anchored" data-anchor-id="sampling-distribution">Sampling Distribution</h3>
<p>Since <span class="math inline">\(\sigma\)</span> is known, we can standardize <span class="math inline">\(\bar X\)</span> as follows:</p>
<p><span class="math display">\[
\frac{\bar X - \mu}{\sigma/\sqrt{n}} \sim N(0,1)
\]</span></p>
</section>
<section id="confidence-interval" class="level3">
<h3 class="anchored" data-anchor-id="confidence-interval">Confidence Interval</h3>
<p>A <span class="math inline">\((1-\alpha)\)</span>CI can be found as:</p>
<p><span class="math display">\[
\bar x \pm z^*\frac{\sigma}{\sqrt n}
\]</span></p>
<p>where <span class="math inline">\(z^*\)</span> = <code>abs(qnorm(alpha/2))</code>.</p>
<p>If we take repeated samples from the population, 95% of the CIs that we construct this way will contain the true population mean. This is <em>not</em> a probability.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="do">## A 94.5% CI</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.055</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">30</span>, <span class="at">mean =</span> <span class="dv">4</span>, <span class="at">sd =</span> sigma)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  -4.96914547   5.84849185  19.87845331  -7.30375674   3.19748243
 [6]   5.32420284  11.07954729   1.60301976  23.84473937   2.61212988
[11]   8.17650751  13.81752777   0.07304644  -6.39668977  21.82228960
[16] -19.11069085  12.78604581   4.35806718  14.12828692   8.32265155
[21]  24.90819205  -7.99925820  19.89638200  23.54651642   4.04937777
[26] -20.51706388   8.77237303  -1.96558169  11.92203270   6.89636710</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>xbar <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>zstar <span class="ot">&lt;-</span> <span class="fu">abs</span>(<span class="fu">qnorm</span>(alpha<span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>xbar <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>)<span class="sc">*</span>zstar<span class="sc">*</span>sigma<span class="sc">/</span><span class="fu">sqrt</span>(n)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.783345 9.790091</code></pre>
</div>
</div>
</section>
<section id="hypothesis-test" class="level3">
<h3 class="anchored" data-anchor-id="hypothesis-test">Hypothesis test</h3>
<p>Prior to collecting data, we have the hypotheses: <span class="math display">\[\begin{align*}
H_0:\mu = \mu_0
H_A: \mu &lt; \mu_0
\end{align*}\]</span></p>
<p>We also must set the significance level <span class="math inline">\(\alpha\)</span> prior to collecting data.</p>
<p>Once we collect data, we calculate the test statistic: <span class="math display">\[
z_{obs} = \frac{\bar x - \mu}{\sigma/\sqrt{n}}
\]</span></p>
<p>Since our alterate hypothesis is “&lt;”, the p-value is found as: <span class="math display">\[
\text{p-value} = P(Z &lt; z_{obs})
\]</span></p>
<p>If <span class="math inline">\(p &lt; \alpha\)</span>, we reject the null hypothesis. In our conclusion, we specify what this means in terms of the study.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Same x as before</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="do">## testing if the population mean is less than 5</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>zobs <span class="ot">&lt;-</span> (xbar <span class="sc">-</span> <span class="dv">5</span>)<span class="sc">/</span>(sigma<span class="sc">/</span><span class="fu">sqrt</span>(n))</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(zobs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7595216</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(zobs) <span class="sc">&lt;</span> alpha <span class="co"># If TRUE, reject null</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
</div>
</section>
<section id="r-code-for-z" class="level3">
<h3 class="anchored" data-anchor-id="r-code-for-z">R Code for z</h3>
<p>There is none, because it’s bonkers to assume that the population sd is known. The z-test is taught for two reasons: to demonstrate the underlying mechanics, and to motivate sample size calculations (discussed later in this document).</p>
</section>
</section>
<section id="inference-about-a-mean-sigma-estimated-by-s" class="level2" data-number="21.3">
<h2 data-number="21.3" class="anchored" data-anchor-id="inference-about-a-mean-sigma-estimated-by-s"><span class="header-section-number">21.3</span> Inference about a Mean, <span class="math inline">\(\sigma\)</span> estimated by <span class="math inline">\(s\)</span></h2>
<section id="assumptions-1" class="level3">
<h3 class="anchored" data-anchor-id="assumptions-1">Assumptions</h3>
<ol type="1">
<li>SRS from the population of interest
<ul>
<li>This ensures independence between observations</li>
</ul></li>
<li>Population is normal (or n is “large” enough)</li>
</ol>
</section>
<section id="sampling-distribution-1" class="level3">
<h3 class="anchored" data-anchor-id="sampling-distribution-1">Sampling Distribution</h3>
<p>Since <span class="math inline">\(s\)</span> is estimated, there is extra variance in our test statistic. The sampling distribution is: <span class="math display">\[\begin{align*}
\bar X &amp;\sim N(\mu, \sigma/\sqrt{n})\\
S &amp;\sim \text{ Something Else}\\
\text{Therefore, } \frac{\bar X - \mu}{S/\sqrt n} &amp;\sim t_{n-1}
\end{align*}\]</span></p>
</section>
<section id="confidence-interval-1" class="level3">
<h3 class="anchored" data-anchor-id="confidence-interval-1">Confidence Interval</h3>
<p><span class="math display">\[
\bar x \pm t_{n-1}^*s/\sqrt{n}
\]</span></p>
<p>where <span class="math inline">\(t_{n-1}^*\)</span> = <code>abs(qt(alpha/2, df = n-1))</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">sd</span>(x)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>tstar <span class="ot">&lt;-</span> <span class="fu">abs</span>(<span class="fu">qt</span>(alpha<span class="sc">/</span><span class="dv">2</span>, n <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>xbar <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)<span class="sc">*</span>tstar<span class="sc">*</span>s<span class="sc">/</span><span class="fu">sqrt</span>(n)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  2.001979 10.571458</code></pre>
</div>
</div>
</section>
<section id="hypothesis-test-1" class="level3">
<h3 class="anchored" data-anchor-id="hypothesis-test-1">Hypothesis Test</h3>
<p>Prior to collecting data, we have the hypotheses: <span class="math display">\[\begin{align*}
H_0:&amp;\mu = \mu_0\\
H_A:&amp;\mu [\ne\text{ or }&gt;\text{ or }&lt;] \mu_0
\end{align*}\]</span></p>
<p>We also must set the significance level <span class="math inline">\(\alpha\)</span> prior to collecting data.</p>
<p>Once we collect data, we calculate the test statistic: <span class="math display">\[
t_{obs} = \frac{\bar x - \mu}{s/\sqrt{n}}
\]</span></p>
<p>If our alterate hypothesis is “<span class="math inline">\(\ne\)</span>”, the p-value is found as: <span class="math display">\[
\text{p-value} = 2*(1-P(T &gt; |t_{obs}|))\text{, or } 2*P(T &lt; -|t_{obs}|)
\]</span></p>
<p>although this is best understood as checking the tails (i.e.&nbsp;if <span class="math inline">\(t_{obs}\)</span> is negative, do <span class="math inline">\(2*P(T &lt; t_{obs})\)</span> and if it’s positive do <span class="math inline">\(2*P(T &lt; -t_{obs})\)</span>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>tobs <span class="ot">&lt;-</span> (xbar <span class="sc">-</span> <span class="dv">5</span>)<span class="sc">/</span>(s<span class="sc">/</span><span class="fu">sqrt</span>(n))</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>tobs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6004565</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pt</span>(<span class="fu">abs</span>(tobs), <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5528661</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pt</span>(<span class="fu">abs</span>(tobs), <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">1</span>)) <span class="sc">&lt;</span> alpha <span class="co"># if TRUE, reject null</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
</div>
</section>
<section id="r-code-for-t" class="level3">
<h3 class="anchored" data-anchor-id="r-code-for-t">R Code for t</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="do">## This gives the same CI and p-value as before</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(x, <span class="at">mu =</span> <span class="dv">5</span>, <span class="at">alternative =</span> <span class="st">"two.sided"</span>, <span class="at">conf.level =</span> <span class="dv">1</span> <span class="sc">-</span> alpha)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  x
t = 0.60046, df = 29, p-value = 0.5529
alternative hypothesis: true mean is not equal to 5
94.5 percent confidence interval:
  2.001979 10.571458
sample estimates:
mean of x 
 6.286718 </code></pre>
</div>
</div>
</section>
</section>
<section id="two-sample-t-tests" class="level2" data-number="21.4">
<h2 data-number="21.4" class="anchored" data-anchor-id="two-sample-t-tests"><span class="header-section-number">21.4</span> Two-Sample t-tests</h2>
<section id="assumptions-2" class="level3">
<h3 class="anchored" data-anchor-id="assumptions-2">Assumptions</h3>
<ul>
<li>Assumptions for one-sample t-tests hold for each sample</li>
<li>Samples are indendent from each other.</li>
</ul>
<p>For a two-sample t-test, we will NEVER assume that the standard deviation is known.</p>
</section>
<section id="sampling-distribution-2" class="level3">
<h3 class="anchored" data-anchor-id="sampling-distribution-2">Sampling Distribution</h3>
<p><span class="math display">\[
\bar X_1 - \bar X_2 \sim N\left(\mu_1 - \mu_2, \sqrt{\frac{s_1^2}{n_1} + \frac{s_2^2}{n_2}}\right)
\]</span></p>
</section>
<section id="confidence-intervals" class="level3">
<h3 class="anchored" data-anchor-id="confidence-intervals">Confidence Intervals</h3>
<p>A <span class="math inline">\((1-\alpha)\)</span> CI for <span class="math inline">\(\mu_d\)</span> is <span class="math display">\[
\bar x_1 - \bar x_2 \pm t^*\sqrt{\frac{s_1^2}{n_1} + \frac{s_2^2}{n_2}}
\]</span></p>
<p>where <span class="math inline">\(t^*\)</span> is based on the smaller of <span class="math inline">\(n_1 - 1\)</span> and <span class="math inline">\(n_2 - 1\)</span></p>
</section>
<section id="hypothesis-tests" class="level3">
<h3 class="anchored" data-anchor-id="hypothesis-tests">Hypothesis Tests</h3>
<p>We are usually testing for the difference in means, i.e. <span class="math display">\[\begin{align*}
H_0: \mu_1 = \mu_2 &amp;\Leftrightarrow H_0:\mu_1 - \mu_2 = \mu_d = 0\\
H_0: \mu_1 &lt; \mu_2 &amp;\Leftrightarrow H_0:\mu_1 - \mu_2 = \mu_d &lt; 0\\
\end{align*}\]</span></p>
<p><span class="math display">\[t_{obs} = \frac{\bar x_1 - \bar x_2}{\sqrt{\frac{s_1^2}{n_1} + \frac{s_2^2}{n_2}}}\]</span></p>
<p><span class="math display">\[
\text{p-value} = P(T &lt; t_{obs}) = \texttt{pt(t\_obs, df = min(n1, n2)-1)}
\]</span></p>
</section>
<section id="r-code-for-two-sample-t-tests" class="level3">
<h3 class="anchored" data-anchor-id="r-code-for-two-sample-t-tests">R Code for two-sample t-tests</h3>
<p>In the code below, the null hypothesis is FALSE, but the effect size is small and the sample sizes aren’t large enough to detect a difference.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">30</span>, <span class="at">mean =</span> <span class="dv">2</span>, <span class="at">sd =</span> <span class="dv">3</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">30</span>, <span class="at">mean =</span> <span class="fl">2.1</span>, <span class="at">sd =</span> <span class="dv">3</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="do">## HA: mu1 - mu2 &lt; 0</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(x1, x2, <span class="at">alternative =</span> <span class="st">"less"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  x1 and x2
t = 0.61442, df = 57.845, p-value = 0.7293
alternative hypothesis: true difference in means is less than 0
95 percent confidence interval:
     -Inf 1.980861
sample estimates:
mean of x mean of y 
 1.894851  1.362458 </code></pre>
</div>
</div>
<p><code>x1</code> and <code>x2</code> have the same sample size, but there’s no reason to match up the first element of <code>x1</code> with the first element of <code>x2</code>, the second element of <code>x1</code> with the second element of <code>x2</code>, etc. The following code is <em>completely</em> inappropriate.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(x1 <span class="sc">-</span> x2, <span class="at">alternative =</span> <span class="st">"less"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  x1 - x2
t = 0.57848, df = 29, p-value = 0.7163
alternative hypothesis: true mean is less than 0
95 percent confidence interval:
     -Inf 2.096155
sample estimates:
mean of x 
 0.532393 </code></pre>
</div>
</div>
</section>
</section>
<section id="inference-about-a-proportion" class="level2" data-number="21.5">
<h2 data-number="21.5" class="anchored" data-anchor-id="inference-about-a-proportion"><span class="header-section-number">21.5</span> Inference about a Proportion</h2>
<section id="assumptions-3" class="level3">
<h3 class="anchored" data-anchor-id="assumptions-3">Assumptions</h3>
<p>First, we check if a binomial distribution is appropriate:</p>
<ol type="1">
<li>Fixed number of trials.</li>
<li>Independent observations.</li>
<li>Outcomes are either “success” or “failure”.
<ul>
<li>E.g. Dice roll is a 5, patient recovered, etc.</li>
</ul></li>
<li>The probability of success is constant for all observations.</li>
</ol>
<p>To use tests and CIs, we need one additional assumption:</p>
<ol type="1">
<li>The sample is an SRS.</li>
</ol>
<p>This covers assumption 3, since SRS ensures independence among observations. It also covers assumption 4: The probability that the first patient recovers is the same as the probability the second patient recovers since the patients come in a random order.</p>
</section>
<section id="sampling-distribution-3" class="level3">
<h3 class="anchored" data-anchor-id="sampling-distribution-3">Sampling Distribution</h3>
<p>We can only approximate the sampling distribution if both <span class="math inline">\(np&gt;10\)</span> and <span class="math inline">\(n(1-p)&gt;10\)</span>, otherwise our sample is too small to say anything meaningful about <span class="math inline">\(p\)</span>. Assuming this is true, the population can be approximated by a normal distribution: <span class="math display">\[
X\stackrel{approx.}{\sim} N(np, \sqrt{np(1-p)})
\]</span></p>
<p>Note that the equation above refers to <span class="math inline">\(X\)</span>, the number of successes out of <span class="math inline">\(n\)</span> trials. This population distribution can be used to find the sampling distribution of the sample proportion: <span class="math display">\[
\hat p \stackrel{approx.}{\sim} N\left(p, \sqrt{\frac{p(1-p)}{n}}\right)
\]</span></p>
<p>where <span class="math inline">\(\hat p\)</span> is the sample proportion (number of successes divided by number of trials) and <span class="math inline">\(p\)</span> is the population proportion.</p>
</section>
<section id="confidence-intervals-1" class="level3">
<h3 class="anchored" data-anchor-id="confidence-intervals-1">Confidence Intervals</h3>
<p>The sampling distribution involves the population proportion, which is not available to us. Instead, we use the sample proportion.</p>
<p><span class="math display">\[
\hat p \pm z^*\sqrt{\frac{\hat p(1-\hat p)}{n}}
\]</span></p>
<p>For the t-test, the t distribution was used because <span class="math inline">\(s\)</span> was estimated. We’re not estimating <span class="math inline">\(s\)</span> here, so there’s no reason to use <span class="math inline">\(t\)</span>. We always use <span class="math inline">\(z\)</span> for proportions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Testing p &gt; 0.35</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>p0 <span class="ot">&lt;-</span> <span class="fl">0.35</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.045</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>xbin <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">30</span>, <span class="at">prob =</span> <span class="fl">0.3</span>)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>phat <span class="ot">&lt;-</span> xbin <span class="sc">/</span> <span class="dv">30</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>zstar <span class="ot">&lt;-</span> <span class="fu">abs</span>(<span class="fu">qnorm</span>(alpha<span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>phat <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)<span class="sc">*</span>zstar<span class="sc">*</span><span class="fu">sqrt</span>(p0<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p0)<span class="sc">/</span><span class="dv">30</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2587633 0.6079033</code></pre>
</div>
</div>
</section>
<section id="hypothesis-tests-1" class="level3">
<h3 class="anchored" data-anchor-id="hypothesis-tests-1">Hypothesis tests</h3>
<p>Prior to collecting data, we have the hypotheses: <span class="math display">\[\begin{align*}
H_0: p = p_0
H_A: p &gt; p_0
\end{align*}\]</span></p>
<p>We also must set the significance level <span class="math inline">\(\alpha\)</span> prior to collecting data.</p>
<p>Again, the standard error involves the true population proportion. However, we now have a hypothesized proportion. This is what we must use.</p>
<p>Once we collect data, we calculate the test statistic: <span class="math display">\[
z_{obs} = \frac{\hat p - p_0}{\sqrt{\frac{p_0(1-p_0)}{n}}}
\]</span></p>
<p>Since our alterate hypothesis is “<span class="math inline">\(\ne\)</span>”, the p-value is found as: <span class="math display">\[
\text{p-value} = P(Z &gt; z_{obs})
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Testing p &gt; 0.35</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>p0 <span class="ot">&lt;-</span> <span class="fl">0.35</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.045</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>xbin <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">30</span>, <span class="at">prob =</span> <span class="fl">0.3</span>)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>phat <span class="ot">&lt;-</span> xbin <span class="sc">/</span> <span class="dv">30</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>zstar <span class="ot">&lt;-</span> <span class="fu">abs</span>(<span class="fu">qnorm</span>(alpha<span class="sc">/</span><span class="dv">2</span>))</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>zobs <span class="ot">&lt;-</span> (phat <span class="sc">-</span> p0)<span class="sc">/</span><span class="fu">sqrt</span>(p0<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p0)<span class="sc">/</span><span class="dv">30</span>)</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(zobs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7170734</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(zobs) <span class="sc">&lt;</span> alpha</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
</div>
</section>
<section id="r-code-for-p" class="level3">
<h3 class="anchored" data-anchor-id="r-code-for-p">R Code for p</h3>
<p>There are two commands for tests/CIs for proportions. One uses something like our normal distribution, and one uses an exact test<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>.</p>
<p>For the following code, specifying <code>alternative = "greater"</code> gives us a one-sided confidence interval. This is not a concept that you need to understand, but this is why the CI looks weird.</p>
<p>The takeaway message here is this: In stats, there is usually more than one way to do things, and there’s not always a clear reason to use one over the other. We teach the basic normal approximation so that you understand at least some of the underlying mechanics, but either of these would be better in a real-world application.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Similar to our p-value (normal approx), but with fancier math</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.test</span>(xbin, <span class="dv">30</span>, <span class="at">alternative =</span> <span class="st">"greater"</span>, <span class="at">conf.level =</span> <span class="fl">0.955</span>, <span class="at">p =</span> <span class="fl">0.35</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    1-sample proportions test with continuity correction

data:  xbin out of 30, null probability 0.35
X-squared = 0.14652, df = 1, p-value = 0.6491
alternative hypothesis: true p is greater than 0.35
95.5 percent confidence interval:
 0.1676928 1.0000000
sample estimates:
  p 
0.3 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Exact test, using a different kind of fancy math</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="do">## There are some drawbacks to using an exact test,</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="do">## but that's outside the scope of this course.</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="fu">binom.test</span>(xbin, <span class="dv">30</span>, <span class="at">p =</span> <span class="fl">0.35</span>, <span class="at">alternative =</span> <span class="st">"greater"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Exact binomial test

data:  xbin and 30
number of successes = 9, number of trials = 30, p-value = 0.7753
alternative hypothesis: true probability of success is greater than 0.35
95 percent confidence interval:
 0.166326 1.000000
sample estimates:
probability of success 
                   0.3 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="do">## CI from before </span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>phat <span class="sc">+</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)<span class="sc">*</span>zstar<span class="sc">*</span><span class="fu">sqrt</span>(p0<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p0)<span class="sc">/</span><span class="dv">30</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.12543 0.47457</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="do">## For confidence intervals, alternative must be two.sided</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.test</span>(xbin, <span class="dv">30</span>, <span class="at">alternative =</span> <span class="st">"two.sided"</span>, <span class="at">conf.level =</span> <span class="fl">0.955</span>, <span class="at">p =</span> <span class="fl">0.35</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    1-sample proportions test with continuity correction

data:  xbin out of 30, null probability 0.35
X-squared = 0.14652, df = 1, p-value = 0.7019
alternative hypothesis: true p is not equal to 0.35
95.5 percent confidence interval:
 0.1519501 0.4996657
sample estimates:
  p 
0.3 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="do">## For confidence intervals, alternative must be two.sided</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">binom.test</span>(xbin, <span class="dv">30</span>, <span class="at">alternative =</span> <span class="st">"two.sided"</span>, <span class="at">conf.level =</span> <span class="fl">0.955</span>, <span class="at">p =</span> <span class="fl">0.35</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Exact binomial test

data:  xbin and 30
number of successes = 9, number of trials = 30, p-value = 0.7027
alternative hypothesis: true probability of success is not equal to 0.35
95.5 percent confidence interval:
 0.1447633 0.4980533
sample estimates:
probability of success 
                   0.3 </code></pre>
</div>
</div>
</section>
</section>
<section id="special-topics-in-inference" class="level2" data-number="21.6">
<h2 data-number="21.6" class="anchored" data-anchor-id="special-topics-in-inference"><span class="header-section-number">21.6</span> Special Topics in Inference</h2>
<section id="sample-size-calculations" class="level3">
<h3 class="anchored" data-anchor-id="sample-size-calculations">Sample Size Calculations</h3>
<p>In order to propose a study<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>, researchers have to give some idea about what results they expect. As we saw before, a small confidence interval is always better<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>. In many grant proposals, researchers choose the sample size based on the desired width of their confidence interval.</p>
<p>Suppose we want a 92% confidence interval for a mean no wider than 2 units on either side. In other words, we want <span class="math inline">\(MoE = 2\)</span>, i.e.&nbsp;<span class="math inline">\(z^*sigma/\sqrt n = 2\)</span>. We know <span class="math inline">\(z^*\)</span>, but we don’t know what our standard deviation is! To get around this, we treat estimates from previous studies as if they’re population values.</p>
<p>If a previous study found a standard deviation of 5, then we have <span class="math inline">\(1.75*5/\sqrt n = 2\)</span>, so <span class="math inline">\(n = (1.75*5/2)^2 = 19.14\)</span>. Of course, <span class="math inline">\(n\)</span> must be an integer. If we round <em>down</em> to 19, then <span class="math inline">\(MoE = 1.75*5/\sqrt{19} = 2.007 &gt; 2\)</span>, but we specified that the MoE <em>cannot</em> be larger than 2! When calculating sample size, <em>never round down</em>.</p>
</section>
<section id="sample-size-calculations-2" class="level3">
<h3 class="anchored" data-anchor-id="sample-size-calculations-2">Sample Size Calculations 2</h3>
<p>It is slightly more correct to use <span class="math inline">\(s\)</span> and a <span class="math inline">\(t^*_{n-1}\)</span> value than <span class="math inline">\(\sigma\)</span> and a <span class="math inline">\(z^*\)</span> value. However, <span class="math inline">\(t^*_{n-1}\)</span> relies on <span class="math inline">\(n\)</span>! There’s no simple way to rearrange the equation for <span class="math inline">\(n\)</span>, so we would just check each value of <span class="math inline">\(n\)</span> until we’re satisfied.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>MoE <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.08</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Using vectorized calculation</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">15</span><span class="sc">:</span><span class="dv">25</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>MoE_vec <span class="ot">&lt;-</span> <span class="fu">abs</span>(<span class="fu">qt</span>(alpha<span class="sc">/</span><span class="dv">2</span>, <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">1</span>))<span class="sc">*</span>s<span class="sc">/</span><span class="fu">sqrt</span>(n) </span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>MoE_vec</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 2.436747 2.347173 2.266834 2.194240 2.128221 2.067837 2.012330 1.961075
 [9] 1.913554 1.869335 1.828051</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Which n gives us the desired MoE?</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>n[MoE_vec <span class="sc">&lt;</span> MoE]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 22 23 24 25</code></pre>
</div>
</div>
<p>So we would use <span class="math inline">\(n = 22\)</span>.</p>
<hr>
<p>Everything below this line is outside the scope of this course.</p>
<hr>
</section>
<section id="inference-for-other-parameters" class="level3">
<h3 class="anchored" data-anchor-id="inference-for-other-parameters">Inference for Other Parameters</h3>
<p>Not everything is normal, and not everything is easily estimated. Here are some quick descriptions of inference for other parameters, along with their sampling distributions:</p>
<ul>
<li>A sequence of means, where we want to know if one of the means is significantly different from the others. This is called Statistical Process Control, or Statistical Quality Control.
<ul>
<li>The distribution of sample means is still normal, even if we have a sequence of them!<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a></li>
<li>Often used in industrial applications to see when a machine needs to be tweaked.</li>
</ul></li>
<li>The standard deviation <span class="math inline">\(\sigma\)</span>: Not often done for one- or two-sample tests, but such tests exist. The sampling distribution is the same as the one I’ve been avoiding: the <span class="math inline">\(\chi^2\)</span><a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a>
<ul>
<li>For <em>Mixed Effects Models</em>, tests around the standard deviation are very important.</li>
<li>There are Statistical Process Control methods for the standard deviation as well!</li>
</ul></li>
<li>The median: Sometimes done, but require strong assumptions about the population.
<ul>
<li>The median is just one of the quartiles, the other quartiles can be estimated as well! The sampling distribution comes from <em>Bootstrap sampling</em>, which takes repeated samples from the sample (assumes the sample is representative of the population). This sounds counterintuitive, but there’s a lot of math showing that this is a reasonable thing to do.</li>
<li>This is sometimes called <em>robust estimation</em>, which is often a type of non-parametric estimation.</li>
</ul></li>
<li>Extreme values: Uses a result called an Extreme Value Theorem.
<ul>
<li>The Generalized Extreme Value Distribution describes the distribution of the largest value in a future sample. This is extremely<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a> useful in predicting/characterizing climate change: if our models predict certain values for maximum rainfall, temperature, etc., but we observe much larger values, then the nature of our data must be changing.</li>
</ul></li>
<li>The spatial/temporal location of observations, e.g.&nbsp;predicting the likely locations of forest fires.
<ul>
<li>See my thesis for examples.</li>
</ul></li>
</ul>
</section>
<section id="bayesian-inference" class="level3">
<h3 class="anchored" data-anchor-id="bayesian-inference">Bayesian Inference</h3>
<p>What if we could say that there’s a 95% chance that the population mean is in the confidence interval? In this case, the population parameter must have a probability distribution!</p>
<p>In order to make any inferences, we have to first make assumptions about the population parameter’s distribution. These assumptions must be reasonable but must <em>not</em> rely on our data (called a “prior” distribution). This is essentially what we do with hypothesis tests, but hypothesis tests are asking about a single value, whereas prior distributions say something about every possible population value. Just like with hypothesis tests, once we incorporate our data we can evaluate how reasonable our prior assumptions were.</p>
<p>This represents a seismic shift in our view of probability. Let’s go back to the coin example that I used for CIs: If a coin has been flipped, then it’s either heads or tails. There’s no probability inherent in the coin, it’s just our knowledge that’s uncertain. To a Bayesian, this is a probability! Bayesiand define probability as a measure of uncertainty. This allows for p-values and CIs as probabilities, although because of the way the math works out there are much better ways to go about these procedures.</p>


</section>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>It uses the actual sampling distribution, which is outside the scope of this course.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>and get funding<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>Assuming it still has the correct “coverage”, e.g.&nbsp;it actually will capture the true value 95% of the time.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>Or t.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>Pronounced “kai square”, sometimes spelled “chi-square”.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>pun intended<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./L23-ANOVA-oi.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Comparing means with ANOVA</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->



</body></html>